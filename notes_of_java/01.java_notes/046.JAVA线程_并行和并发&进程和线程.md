<!-- TOC -->

- [1. 并行和并发](#1-并行和并发)
  - [1.1. 概念和区别](#11-概念和区别)
    - [1.1.1. 并行的概念](#111-并行的概念)
    - [1.1.2. 并发的概念](#112-并发的概念)
    - [1.1.3. 计算机层面上的阐释](#113-计算机层面上的阐释)
- [2. 进程和线程](#2-进程和线程)
  - [2.1. 概念分析](#21-概念分析)
    - [2.1.1. 进程的概念](#211-进程的概念)
    - [2.1.2. 线程的概念](#212-线程的概念)
    - [2.1.3. 多进程和多线程](#213-多进程和多线程)
  - [2.2. 进程与线程的区别](#22-进程与线程的区别)
    - [2.2.1. 进程的空间分配](#221-进程的空间分配)
    - [2.2.2. 线程的空间分配](#222-线程的空间分配)
    - [2.2.3. 线程的执行安排](#223-线程的执行安排)
    - [2.2.4. 进程的运行和线程的调度](#224-进程的运行和线程的调度)
  - [2.3. 多线程的优势](#23-多线程的优势)
    - [2.3.1. 多线程下载的原理](#231-多线程下载的原理)

<!-- /TOC -->

## 1. 并行和并发

### 1.1. 概念和区别
- 以下概念均指代的是微观情况

#### 1.1.1. 并行的概念
- 指两个或多个事件在同一时刻点发生

#### 1.1.2. 并发的概念
- 指两个或多个事件在同一时间段内发生(指的是类似于 0.01ms 长度的微观时间段)

#### 1.1.3. 计算机层面上的阐释
- 在操作系统中, 在多道程序环境下, 并发性是指在一段时间内宏观上有多个程序在同时运行,  
但在单 CPU 系统中, 每一时刻仅能有一道程序执行 (时间片: CPU 分配给各程序的运行时间,  
也是围观的概念), 故微观上这些程序只能是分时地交替执行.  

- 倘若计算机系统中有多个 CPU, 则这些可以并发执行的程序便可被分配到多个处理器上,  
从而实现多任务并行执行, 即利用每个处理器来处理一个可并发执行的程序,  
这样, 多个程序便可同时执行, 因为是微观的, 所以宏观上感觉就是多个程序是同时执行.  

- 因此多核处理器之所以能提高了电脑的运行效率, 是因为可以同时并行地处理多个程序.  

- 单核处理器的计算机是不能并行处理多个任务的, 只能是多个任务在单个 CPU 上并发运行.   

- 同理, 线程也是一样的, 从宏观角度上线程是并行运行的, 但微观角度上分析却是串行运行的,  
即一个线程一个线程的去运行, 当系统只有一个CPU时, 线程会以某种顺序执行多个线程,  
这种情况就称为线程调度. 

## 2. 进程和线程

### 2.1. 概念分析  

#### 2.1.1. 进程的概念
- 进程是指一个内存中运行中的应用程序. 每个进程都有一块独立的内存空间,  
  一个应用程序可同时启动多个进程. 例如 Windows 中, 一个运行的 xx.exe 就是一个进程.  

- 那么我们此时就可以处理同时玩游戏和听音乐的问题了, 我们可以设计成两个程序,  
一个专门负责玩游戏, 一个专门负责听音乐.   

- 但是有时候开发一种软件例如游戏, 其内部会有多个功能同时调动的需求, 例如每个人物的活动,  
若要使用进程实现, 则可能要开 N 个进程才能完成, 这样的设计显然是不合理的.  

- 而且大多数操作系统都不需要一个进程访问其他进程的内存空间, 因此进程间的通信很不方便.  
此时需要得引入“线程”这门技术, 来解决这个问题.  

#### 2.1.2. 线程的概念
- 线程是指进程中的一个执行任务(控制单元), 一个进程可同时并发多个线程,  
  例如多线程下载软件运用的就是这个原理.  

- 一个进程至少有一个线程, 为了提高效率, 可在一个进程中开启多个执行任务,  
  这种情况则称为多线程.  

#### 2.1.3. 多进程和多线程
- 多进程: 操作系统中同时运行的多个程序.  
- 多线程: 在同一个进程中同时运行的多个任务.  

- Win 环境下的任务管理器:  
  在操作系统中允许存在多个任务, 每一个任务就是一个进程;  
  每一个进程又可同时执行多个子任务, 每一个子任务就是线程. 

### 2.2. 进程与线程的区别

#### 2.2.1. 进程的空间分配  
- 有独立的内存空间, 每个进程中的数据存放空间(包括堆空间和栈空间)都是相互独立的,   
  而且每个进程中都应至少有一个线程, 否则这个进程毫无意义.  
  实际上 Java 程序的进程里至少包含两个线程: 主线程和垃圾回收线程(后台线程).

#### 2.2.2. 线程的空间分配  
- 线程所处的是进程中栈中的堆空间, 而堆空间是共享的, 栈空间是独立的,   
  因此线程之间可以相互影响, 同时线程消耗资源也比进程小,   
  因此线程又被称为轻量进程或进程元.  

#### 2.2.3. 线程的执行安排  
- 因为一个进程中的多个线程是并发运行的, 但在微观角度上线程执行是有先后顺序的,   
  不过哪个线程执行完全取决于 CPU 调度器(JVM的调整), 编码人员是无法进行控制的.  

- 因此可以把多线程并发看作是多个线程在瞬间抢 CPU 资源,  
  哪个线程抢到资源就运行这个线程, 因此也造就了多线程的随机性.   

#### 2.2.4. 进程的运行和线程的调度  
- 计算机通常只有一个 CPU 时, 在任一时刻只能执行一条计算机指令,  
  每一个进程只有获得 CPU 的使用权才能执行指令.  
  
- 多进程并发运行, 从宏观上看其实是各个进程轮流获得 CPU 的使用权,  
  分别执行各自的任务, 因此在可运行池中, 会有多个线程处于就绪状态,  
  一旦抢到了 CPU 资源, 就开始执行. 
  
- JVM 就负责的是线程的调度. JVM 采用的是抢占式调度,  
  没有采用分时调度, 因而造成多线程执行结果的随机性.

   
### 2.3. 多线程的优势
多线程作为一种多任务, 并发的工作方式, 存在着如下优势:  
- 进程之间并不能共享内存, 但线程之间(堆内存)可以.

- 系统创建进程时需要为该进程重新分配系统资源,  
  而创建线程的代价则小很多, 因此实现多任务并发时,  
  采用多线程会让效率更高.

- Java 本身内置多线程功能的支持, 而不是单纯地作为  
  底层系统的调度方式, 从而简化了多线程编程.

#### 2.3.1. 多线程下载的原理
- 可以理解为一个线程就是一个文件的下载通道, 多线程就是同时开启好几个下载通道.  

- 当服务器提供下载服务时, 使用下载者是共享带宽的, 在优先级相同的情况下,  
总服务器会对总下载线程进行平均分配. 因此线程越多, 下载速度越快.  

- 多线程是为了同步完成多项任务, 不是为了提供程序运行效率,  
而是通过提高资源使用效率来提高系统的效率.